<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="PayTransFlowInfoMap" xmlns="http://ibatis.apache.org/mapping" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<alias>
	<typeAlias alias="PayTransFlowInfo" type="DataAccess.Domain.PayTransFlowInfo" />
</alias>
<resultMaps>
		<resultMap id="PayTransFlowInfoResult" class="PayTransFlowInfo">
      <result property="AcctSeqId" column="AcctSeqId" type="string" dbType="varchar"/>
      <result property="PosMerId" column="PosMerId" type="string" dbType="varchar"/>
      <result property="PosMerName" column="PosMerName" type="string" dbType="varchar"/>
      <result property="PayOrdId" column="PayOrdId" type="string" dbType="varchar"/>
      <result property="PayAmt" column="PayAmt" type="double" dbType="numeric(14,2)"/>
      <result property="PnrDevId" column="PnrDevId" type="string" dbType="varchar"/>
      <result property="MerName" column="MerName" type="string" dbType="varchar"/>
      <result property="TerminalNo" column="TerminalNo" type="string" dbType="varchar"/>
      <result property="CardNo" column="CardNo" type="string" dbType="varchar"/>
      <result property="IssBank" column="IssBank" type="string" dbType="varchar"/>
      <result property="AcqOrg" column="AcqOrg" type="string" dbType="varchar"/>
      <result property="ExpDate" column="ExpDate" type="string" dbType="varchar"/>
      <result property="TransType" column="TransType" type="string" dbType="varchar"/>
      <result property="OldPayOrderId" column="OldPayOrderId" type="string" dbType="varchar"/>
      <result property="BatchId" column="BatchId" type="string" dbType="varchar"/>
      <result property="CreateDate" column="CreateDate" type="string" dbType="varchar"/>
      <result property="CreateTime" column="CreateTime" type="string" dbType="varchar"/>
      <result property="OperId" column="OperId" type="string" dbType="varchar"/>
      <result property="TransStatus" column="TransStatus" type="string" dbType="varchar"/>
      <result property="FailureReason" column="FailureReason" type="string" dbType="varchar"/>
      <result property="AuthNo" column="AuthNo" type="string" dbType="varchar"/>
      <result property="RefNo" column="RefNo" type="string" dbType="varchar"/>
      <result property="VoucherNo" column="VoucherNo" type="string" dbType="varchar"/>
      <result property="Reference" column="Reference" type="string" dbType="varchar"/>
    </resultMap>
</resultMaps>
<statements>
	
<select id="SelectPayTransFlowInfo" parameterClass="string" resultClass="PayTransFlowInfo">
  SELECT AcctSeqId AS AcctSeqId,PosMerId AS PosMerId,PosMerName AS PosMerName,PayOrdId AS PayOrdId,PayAmt AS PayAmt,PnrDevId AS PnrDevId,MerName AS MerName,TerminalNo AS TerminalNo,CardNo AS CardNo,IssBank AS IssBank,AcqOrg AS AcqOrg,ExpDate AS ExpDate,TransType AS TransType,OldPayOrderId AS OldPayOrderId,BatchId AS BatchId,CreateDate AS CreateDate,CreateTime AS CreateTime,OperId AS OperId,TransStatus AS TransStatus,FailureReason AS FailureReason,AuthNo AS AuthNo,RefNo AS RefNo,VoucherNo AS VoucherNo,Reference AS Reference
  FROM PayTransFlowInfo
  <dynamic prepend="WHERE">
<isParameterPresent>AcctSeqId = #value#
</isParameterPresent>
</dynamic>
</select>
<insert id="InsertPayTransFlowInfo" parameterClass="PayTransFlowInfo">
  INSERT INTO PayTransFlowInfo
  (AcctSeqId,PosMerId,PosMerName,PayOrdId,PayAmt,PnrDevId,MerName,TerminalNo,CardNo,IssBank,AcqOrg,ExpDate,TransType,OldPayOrderId,BatchId,CreateDate,CreateTime,OperId,TransStatus,FailureReason,AuthNo,RefNo,VoucherNo,Reference)
  VALUES(#AcctSeqId#,#PosMerId#,#PosMerName#,#PayOrdId#,#PayAmt#,#PnrDevId#,#MerName#,#TerminalNo#,#CardNo#,#IssBank#,#AcqOrg#,#ExpDate#,#TransType#,#OldPayOrderId#,#BatchId#,#CreateDate#,#CreateTime#,#OperId#,#TransStatus#,#FailureReason#,#AuthNo#,#RefNo#,#VoucherNo#,#Reference#)
</insert>
<update id="UpdatePayTransFlowInfo" parameterClass="PayTransFlowInfo">
  UPDATE PayTransFlowInfo
  SET PosMerId=#PosMerId#,PosMerName=#PosMerName#,PayAmt=#PayAmt#,PnrDevId=#PnrDevId#,MerName=#MerName#,TerminalNo=#TerminalNo#,CardNo=#CardNo#,IssBank=#IssBank#,AcqOrg=#AcqOrg#,ExpDate=#ExpDate#,TransType=#TransType#,BatchId=#BatchId#,TransStatus=#TransStatus#,FailureReason=#FailureReason#,AuthNo=#AuthNo#,RefNo=#RefNo#,VoucherNo=#VoucherNo#
  WHERE AcctSeqId = #AcctSeqId#
</update>
  <update id="UpdatePayCancel" parameterClass="PayTransFlowInfo">
    UPDATE PayTransFlowInfo
    SET PosMerId=#PosMerId#,PosMerName=#PosMerName#,PayOrdId=#PayOrdId#,PayAmt=#PayAmt#,PnrDevId=#PnrDevId#,MerName=#MerName#,TerminalNo=#TerminalNo#,CardNo=#CardNo#,IssBank=#IssBank#,AcqOrg=#AcqOrg#,ExpDate=#ExpDate#,TransType=#TransType#,OldPayOrderId=#OldPayOrderId#,BatchId=#BatchId#,CreateDate=#CreateDate#,CreateTime=#CreateTime#,OperId=#OperId#,TransStatus=#TransStatus#,FailureReason=#FailureReason#,AuthNo=#AuthNo#,RefNo=#RefNo#,VoucherNo=#VoucherNo#,Reference=#Reference#
    WHERE AcctSeqId = #AcctSeqId#
  </update>
<delete id="DeletePayTransFlowInfo" parameterClass="string">
DELETE FROM PayTransFlowInfo
WHERE AcctSeqId = #value#
</delete>
  
<select id="SelectMaxSerialNumber" resultClass="long" parameterClass="string">
  SELECT MAX(cast(substr(AcctSeqId,15,6) as bigint)) as MaxSerialNumber FROM PayTransFlowInfo
  where CreateDate=#value#
</select>
  
<!--<select id="SelectAcctSeqId" parameterClass="string" resultClass="PayTransFlowInfo">
  SELECT AcctSeqId AS AcctSeqId FROM PayTransFlowInfo
  <dynamic prepend="WHERE">
    <isParameterPresent>
      <isNotEmpty prepend="and" property="PayOrdId">PayOrdId=#PayOrdId#</isNotEmpty>
      <isNotEmpty prepend="and" property="PayAmt">PayAmt=#PayAmt#</isNotEmpty>
    </isParameterPresent>
  </dynamic>
</select>-->
  <select id="SelectAcctSeqId" resultClass="string" parameterClass="PayTransFlowInfo">
    SELECT AcctSeqId AS AcctSeqId FROM PayTransFlowInfo
    WHERE PayOrdId = #PayOrdId#
  </select>
  <select id="SelectAllPayData" resultClass="PayTransFlowInfo" parameterClass="PayTransFlowInfo">
    SELECT  * FROM PayTransFlowInfo
    WHERE PayOrdId = #PayOrdId#
  </select>
<update id="UpdateTransStatus" parameterClass="PayTransFlowInfo">
  UPDATE PayTransFlowInfo
  SET TransStatus=#TransStatus#,FailureReason=#FailureReason#
  WHERE AcctSeqId = #AcctSeqId#
</update>
</statements>
</sqlMap>
